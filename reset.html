<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Modifier le mot de passe</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h1>ğŸ” Modifier le mot de passe</h1>
  <p id="debugInfo" style="color:blue;"></p>

  <form id="resetForm">
    <input type="password" id="newPassword" placeholder="Nouveau mot de passe" required>
    <button class="btn" type="submit">Modifier</button>
  </form>
  <p id="message"></p>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
    import { getAuth, onAuthStateChanged, updatePassword } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-auth.js";

    const firebaseConfig = {
        apiKey: "AIzaSyCL3rtG0CcD4T6XGEGfGtHLU39rp_wsSqA",
  authDomain: "multijeugo.firebaseapp.com",
  projectId: "multijeugo",
  storageBucket: "multijeugo.firebasestorage.app",
  messagingSenderId: "181253022362",
  appId: "1:181253022362:web:3eca9851efdb7541a5f523",
  measurementId: "G-YKC3SHW17Q"
};
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    const resetForm = document.getElementById("resetForm");
    const newPassword = document.getElementById("newPassword");
    const message = document.getElementById("message");
    const debugInfo = document.getElementById("debugInfo");

    let currentUser = null;

    onAuthStateChanged(auth, (user) => {
      if (!user) {
        debugInfo.textContent = "âŒ Tu dois Ãªtre connectÃ© pour modifier ton mot de passe.";
        window.location.href = "login.html";
        return;
      }
      currentUser = user;
      debugInfo.textContent = `âœ… ConnectÃ© : ${user.email}`;
    });

    resetForm.onsubmit = async (e) => {
      e.preventDefault();
      try {
        await updatePassword(currentUser, newPassword.value);
        message.textContent = "âœ… Mot de passe modifiÃ© avec succÃ¨s.";
        newPassword.value = "";
      } catch (err) {
        message.textContent = "âŒ Erreur : " + err.message;
      }
    };
  </script>
</body>
</html>
